{% extends "base.html" %}

{% block title %}새 카테고리 추가 - APS 준비도 진단{% endblock %}

{% block content %}
<div class="d-flex justify-content-between align-items-center mb-4">
    <h2>새 평가 영역(카테고리) 추가</h2>
    <a href="{{ url_for('categories') }}" class="btn btn-secondary">카테고리 목록으로</a>
</div>

<div class="row">
    <div class="col-md-8">
        <div class="card">
            <div class="card-body">
                <form method="POST">
                    <div class="mb-3">
                        <label for="name" class="form-label">영역명 <span class="text-danger">*</span></label>
                        <input type="text" class="form-control" id="name" name="name" 
                               placeholder="예: 시스템 연동 평가" required>
                        <div class="form-text">평가 영역의 이름을 입력하세요.</div>
                    </div>
                    
                    <div class="mb-3">
                        <label for="weight" class="form-label">가중치 <span class="text-danger">*</span></label>
                        <div class="input-group">
                            <input type="number" class="form-control" id="weight" name="weight" 
                                   step="0.01" min="0" max="1" placeholder="0.20" required>
                            <span class="input-group-text">%</span>
                        </div>
                        <div class="form-text">
                            0.01~1.00 사이의 값을 입력하세요. (예: 0.20 = 20%)
                            <br><strong>참고:</strong> 전체 카테고리의 가중치 합계는 1.00(100%)이 되어야 합니다.
                        </div>
                    </div>
                    
                    <div class="mb-4">
                        <label for="description" class="form-label">설명</label>
                        <textarea class="form-control" id="description" name="description" rows="3"
                                  placeholder="이 평가 영역에 대한 상세 설명을 입력하세요."></textarea>
                        <div class="form-text">평가 영역에 대한 자세한 설명을 입력하세요.</div>
                    </div>
                    
                    <div class="d-grid gap-2 d-md-flex justify-content-md-end">
                        <a href="{{ url_for('categories') }}" class="btn btn-outline-secondary me-md-2">취소</a>
                        <button type="submit" class="btn btn-primary">카테고리 추가</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
    
    <div class="col-md-4">
        <div class="card">
            <div class="card-header">
                <h6 class="card-title mb-0">가이드</h6>
            </div>
            <div class="card-body">
                <h6>카테고리 추가 시 고려사항:</h6>
                <ul class="small">
                    <li><strong>영역명:</strong> 명확하고 구분되는 이름 사용</li>
                    <li><strong>가중치:</strong> 전체 합계가 1.00이 되도록 조정</li>
                    <li><strong>순서:</strong> 자동으로 마지막 순서로 배정됩니다</li>
                    <li><strong>문항:</strong> 카테고리 생성 후 문항을 별도로 추가해야 합니다</li>
                </ul>
                
                <div class="alert alert-info mt-3">
                    <small>
                        <strong>팁:</strong> 카테고리 추가 후 기존 카테고리들의 가중치를 조정하여 
                        전체 합계가 100%가 되도록 해주세요.
                    </small>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
// 가중치 입력 시 백분율로 표시하는 기능
document.getElementById('weight').addEventListener('input', function() {
    const value = parseFloat(this.value);
    if (!isNaN(value)) {
        const percentage = (value * 100).toFixed(1);
        const helpText = this.parentNode.nextElementSibling;
        const currentText = helpText.innerHTML;
        const newText = currentText.replace(/\(현재: [\d.]+%\)/g, '') + 
                       ` <span class="text-primary">(현재: ${percentage}%)</span>`;
        helpText.innerHTML = newText;
    }
});
</script>
{% endblock %}